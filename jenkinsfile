pipeline{
agent any 
    stages {
            stage('Build')
    {
        steps {
            sh 'WEB_IMAGE_NAME="aishwaryashinde/go-web:kube${BUILD_NUMBER}"'
 sh 'docker build -t aishwaryashinde/go-web:kube29 '
sh 'docker login -u aishwaryashinde -p ${DOCKER_HUB}'
sh 'docker push $WEB_IMAGE_NAME '     
}  
   
   }
   
    stage('Deployment')
    {
        steps {
           sh 'WEB_IMAGE_NAME="aishwaryashinde/go-web:kube29"'
           sh ' create -f ${WORKSPACE}/go-web.yaml || true'
sh 'kubectl set image deployment/go-web go-web=$WEB_IMAGE_NAME --kubeconfig /var/lib/jenkins/.kube/config'
             }
    }
}
}
